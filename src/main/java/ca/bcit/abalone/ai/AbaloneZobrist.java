package ca.bcit.abalone.ai;

import ca.bcit.abalone.game.AbaloneGame;

public class AbaloneZobrist implements Zobrist<Character, AbaloneGame.State, AbaloneGame.Action, AbaloneGame> {

    private static final AbaloneZobrist INSTANCE = new AbaloneZobrist();

    public static final long MAX_PLAYER_VALUE = -5094439878719765614L;

    public static final long[][] zobrist = new long[][]{
            {-6498159856081002000L, -4335053656200495000L, -4089899451436048400L, 1526475928917725000L, -2246747749462525700L, 3662275725295994400L, 5895232640041266000L, 7802304532533444000L, -4003656638198581000L, -1448786536071773200L, 6301176025372605000L, 2417360887892969500L, -4618847907964300000L, 5687167855607806000L, -7578297034531016000L, 1430537212234073600L, -3353262289300349400L, 8335859319202742000L, -2138734239575477800L, -2204079420641683700L, -5639490783052946000L, 7871556215301231000L, 2725191418826772000L, -3026083196081307600L, -6029364737911117000L, -8539163482449386000L, -2508266730195761000L, 3629781562040995300L, 3045527493697619000L, 6886017139056792000L, 53177918756010460L, -3911570261475307000L, 6838562967351286000L, 6198409687179438000L, -3630553818953329700L, -1412960531896130600L, -3731468645952676400L, -6320038578459926000L, -561126294705457900L, -7405785028426107000L, -4920681266032390000L, -2834567122887595500L, -4119164006284211000L, -501126555837626200L, 9037232873240080000L, -1535832071299986700L, 5423352220628748000L, 4204285391685404700L, 4221599665150260700L, -5188561448695777000L, 8214842692286569000L, -203235803778257300L, 7935447190577963000L, 3441736463990724600L, -1852534155641514800L, -6795384488426060000L, -6852686407683030000L, 6294184382179533000L, -2724716945225255400L, -725168798145422100L, -2567309655212275700L},
            {8131129117637609000L, -7326581423769114000L, -1024325700599942700L, 7082036003634908000L, -4427365362460999000L, 8439284363015199000L, 7651353173174206000L, -7183703509902161000L, 1781077166042879200L, -1906634405667055900L, -1799571138070865400L, -2099301212248680000L, 4670901286035154000L, 2430348545011985400L, 1248942328107516000L, -5866532724670256000L, 7817186371270852000L, 2742002245083475000L, -9107033438771370000L, 290833086656851500L, -6936989581160024000L, 1544197946284132400L, 1191969659513536300L, 7908632038303646000L, 936877843935239200L, 5761326263601437000L, 3336829875669432300L, -6578431176130799000L, -8689030693534552000L, -1067636576810104700L, 3409666822554582000L, 1992486574866361000L, 143077913052590850L, 9196978711940546000L, -1218250382069752300L, -136611465450104370L, 7555419043195621000L, 8597365083176362000L, -6592893935772673000L, -2894586275134502400L, -17286337245397272L, 97719743352351710L, 4953797279303384000L, 437883125392738000L, -2933184952064851000L, -7271020524777154000L, 6676784687437885000L, 5187584922183538000L, -2836432748731824600L, -6405230854462355000L, -2717587669260807700L, 4604950233715246600L, 6762579002054468000L, -2081416605226564600L, -2678958296543601000L, 8895073856319319000L, 5399846724421821000L, -8811501000059350000L, 3696649861426319400L, -6582736524065077000L, 2464797340358165000L}
    };

    public static AbaloneZobrist getInstance() {
        return INSTANCE;
    }

    private AbaloneZobrist() {
    }

    @Override
    public long hashCode(AbaloneGame game) {
        char[] state = game.state.getBoard();
        long hashValue = 0;
        for (int i = 0; i < state.length; i++) {
            switch (state[i]) {
                case AbaloneGame.BLACK:
                    hashValue ^= zobrist[1][i];
                    break;
                case AbaloneGame.WHITE:
                    hashValue ^= zobrist[0][i];
                    break;
            }
        }
        if (game.getPlayer() == AbaloneGame.BLACK) {
            hashValue ^= MAX_PLAYER_VALUE;
        }
        return hashValue;
    }

    @Override
    public long hashCode(AbaloneGame game, AbaloneGame.Action action) {
        return hashCode(game);
    }

    public static void main(String[] args) {
        AbaloneGame game = new AbaloneGame(new AbaloneGame.State(AbaloneGame.STANDARD_INITIAL_STATE, 1), 80);
        AbaloneZobrist zobrist = AbaloneZobrist.getInstance();
        System.out.println(zobrist.hashCode(game));
    }

}
